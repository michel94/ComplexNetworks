<!DOCTYPE HTML>
<html>
	<head>
		<script type="text/javascript" src="vis.min.js"></script>
		<script type="text/javascript" src="game.js"></script>
    	<link href="vis.min.css" rel="stylesheet" type="text/css" />
		
		<title> Prisioner's Dilemma</title>
		<style>
			body {
				margin: 0px;
				padding: 0px;
			}
		</style>

		<style type="text/css">
        #netDiv {
            width: 704px;
            height: 704px;
            border: 1px solid lightgray;
        }
    	</style>

	</head>
	<body>
	<button action="start">Start</button>
		<div id="netDiv"></div>
		<canvas id="myCanvas" width="704" height="704"></canvas>
		<script>
			// {'C': "#17097A", 'D': "#7A0933"}

			// Lattice Game
			
			/*canvas = document.getElementById('myCanvas');
			Game.setup(canvas, Player, 20);
			Game.randomInit(176*2, 176*2, ['C', 'D']);
			Game.start();*/
			
			// Graph Game
			var SIZE = 100;
			var N_ITERATIONS = 500;
			var graph1 = GraphGame.ABModel(SIZE, 2);
			var graph2 = GraphGame.DuplicationModel(SIZE, 0.2);
			var graph3 = GraphGame.MinimalModel(SIZE);

			var Player = new PlayerFactory(
				{colors: {'C': '#0000FF', 'D': '#FF0000'}},
				function(other){
					var R = 1;
					var t = T;
					var s = S;
					var P = 0;
					if(this.type == 'C'){
						if(other.type == 'C')
							return R;
						else
							return s;
					}else{
						if(other.type == 'C')
							return t;
						else
							return P;
					}
				}
			)

			GraphGame.setup(document.getElementById('netDiv'), Player, 4);
			GraphGame.randomInit(graph1, SIZE, ['C', 'D'], function(){} );
			GraphGame.maxIterations = N_ITERATIONS;
			console.log(graph1)

			max_degree = (function(l){
					var m = null;
					for(var i in l){
						if(m == null || l[i].length > m.length){
							m = l[i];
						}
					}

					return m.length;
				}) (graph1);

			deg_dist = new Array(max_degree+1);
			for(var i = 0; i < max_degree+1; i++)
				deg_dist[i] = 0;
			sum = function(l){
				var s = 0
				for(var i=0; i<l.length; i++) s+= l[i].length;
				return s;
			}
			for(var i in graph1)
				deg_dist[graph1[i].length]++;
			

			//GraphGame.setup('', Player, 20);

			/*var initialized = false;
			syncInit = function(){
				if(!initialized){
					console.log('ready');
					initialized = true;
				}
			}
			
			
			function run(nRuns, T, S, finished){
				var start = new Date().getTime();
				
				if(nRuns <= 0){
					var C = 0;
					if('C' in GraphGame.counts)
						C = GraphGame.counts['C'];

					var D = 0;
					if('D' in GraphGame.counts)
						D = GraphGame.counts['D'];
					
					var p = C / (C+D);
					results[[T, S]] = p;
					console.log(T + ", " + S + ": " + p)

					finished();
					return;
				}

				GraphGame.setup(document.getElementById('netDiv'), Player, 10000);
				GraphGame.randomInit(graph, SIZE, ['C', 'D'], function(){} );
				GraphGame.maxIterations = N_ITERATIONS;

				GraphGame.start();
				GraphGame.stop = function(){
					end = new Date().getTime();
					console.log( (end-start)/1000 );
					
					run(nRuns-1, T, S, finished);
				};
			}
			var points = []

			for(var s=-1; s<=1; s+=0.1)
				for(var t=0; t<=2; t+=0.1)
					points.push([t, s]);
			

			results = {};
			function nextV(){
				var v = points.shift()
				run(1, v[0], v[1], function(){});

			}
			nextV();*/

			//run(1, 1.5, 0.75, finished);
			
			
			
		</script>
	</body>
</html>

